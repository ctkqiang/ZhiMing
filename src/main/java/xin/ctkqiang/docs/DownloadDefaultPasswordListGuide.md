# Download Default Password List 功能指南

## 功能概述

"Download Default Password List" 是一个专门为用户设计的便捷功能，允许用户直接从Issues菜单下载默认的密码字典文件到本地系统。

## 使用方法

### 1. 启动下载
- 打开ZhiMing应用
- 点击顶部菜单栏的 **"帮助"**
- 选择 **"Download Default Password List"**

### 2. 下载确认
系统将显示确认对话框，包含：
- 默认下载目录路径
- 文件名：password.txt
- 文件大小提示

### 3. 下载过程
- 显示实时进度条
- 显示下载速度和剩余时间
- 提供"取消下载"按钮

### 4. 下载完成
- 自动重命名为标准格式：password.txt
- 显示文件完整路径
- 显示文件大小和校验信息

## 技术实现

### 文件存储位置
- **Windows**: `C:\Users\[用户名]\Downloads\password.txt`
- **macOS**: `/Users/[用户名]/Downloads/password.txt`
- **Linux**: `/home/[用户名]/Downloads/password.txt`

### 错误处理
- 网络连接失败
- 存储空间不足
- 文件权限问题
- 下载中断恢复

### 安全特性
- SHA-256完整性校验
- 文件权限设置为600（仅所有者可读写）
- 临时文件自动清理

## 集成架构

```
┌─────────────────────────────────────┐
│  UI层 (Window.java)                 │
│  ├─ Issues菜单                      │
│  ├─ Download Default Password List  │
│  └─ 进度对话框                      │
├─────────────────────────────────────┤
│  服务层 (DownloadService)           │
│  ├─ 线程安全管理                    │
│  ├─ 错误处理                        │
│  └─ 资源清理                        │
├─────────────────────────────────────┤
│  引擎层 (DownloadManager)           │
│  ├─ HTTPS下载                       │
│  ├─ 进度跟踪                        │
│  └─ 完整性校验                      │
└─────────────────────────────────────┘
```

## 代码集成验证

### 1. 菜单集成
- ✅ Issues菜单新增"Download Default Password List"选项
- ✅ 事件监听器正确绑定
- ✅ 与现有菜单风格保持一致

### 2. 功能集成
- ✅ 使用DownloadService进行下载管理
- ✅ 使用DownloadManager处理实际下载
- ✅ 线程安全的并发控制

### 3. 用户体验
- ✅ 友好的确认对话框
- ✅ 实时进度显示
- ✅ 详细的错误提示
- ✅ 下载完成确认

## 测试验证

运行测试类验证功能：
```bash
java xin.ctkqiang.test.MenuIntegrationTest
```

### 测试场景
1. **正常下载**：网络正常，空间充足
2. **并发测试**：多次点击菜单项
3. **取消测试**：中途取消下载
4. **错误测试**：网络断开、空间不足

## 故障排除

### 常见问题

**Q: 菜单项不显示**
- 检查Window.java是否正确编译
- 确认菜单添加顺序

**Q: 下载失败**
- 检查网络连接
- 验证磁盘空间
- 查看日志获取详细信息

**Q: 文件未找到**
- 检查默认下载目录权限
- 确认文件是否被重命名成功

### 日志查看

下载过程中的详细日志可在应用控制台查看，包含：
- 网络连接状态
- 文件操作记录
- 错误详细信息

## 扩展建议

### 未来增强
1. **下载源配置**：允许用户选择不同的密码列表源
2. **断点续传**：支持大文件断点续传
3. **批量下载**：支持多个密码列表同时下载
4. **定时更新**：自动检查并更新密码列表

### 配置选项
- 自定义下载目录
- 代理服务器支持
- 下载速度限制
- 自动重试次数配置

## 最佳实践

### 开发建议
1. **错误处理**：始终提供用户友好的错误消息
2. **资源管理**：确保所有资源正确释放
3. **用户体验**：保持界面响应性
4. **日志记录**：详细记录操作过程

### 使用建议
1. **定期更新**：建议定期下载最新密码列表
2. **备份旧文件**：下载前备份现有密码文件
3. **验证完整性**：使用SHA-256校验文件完整性